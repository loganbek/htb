<!--
 // Platform: Academy
// URL: https://academy.hackthebox.com/module/233/section/2555
// Platform Version: V1
// Module ID: 233
// Module Name: Detecting Windows Attacks with Splunk
// Module Difficulty: Medium
// Section ID: 2555
// Section Title: Detecting Beaconing Malware
// Page Title: Hack The Box - Academy
// Page Number: 13
-->

# Detecting Beaconing Malware

**Module Name:** Detecting Windows Attacks with Splunk **Page Number:** 13

#### 

#### DETECTING WINDOWS ATTACKS WITH SPLUNK

# Detecting Beaconing Malware

``` shell-session
[!bash!]$ xfreerdp /u:htb-student /p:'HTB_@cademy_stdnt!' /v:[Target IP] /dynamic-resolution
```

#### Related Evidence

## Detecting Beaconing Malware With Splunk & Zeek Logs

``` shell-session
index="cobaltstrike_beacon" sourcetype="bro:http:json" 
| sort 0 _time
| streamstats current=f last(_time) as prevtime by src, dest, dest_port
| eval timedelta = _time - prevtime
| eventstats avg(timedelta) as avg, count as total by src, dest, dest_port
| eval upper=avg*1.1
| eval lower=avg*0.9
| where timedelta > lower AND timedelta < upper
| stats count, values(avg) as TimeInterval by src, dest, dest_port, total
| eval prcnt = (count/total)*100
| where prcnt > 90 AND total > 10
```

![https://academy.hackthebox.com/storage/modules/233/102.png](https://academy.hackthebox.com/storage/modules/233/102.png)

# 

# 

#### Questions

####